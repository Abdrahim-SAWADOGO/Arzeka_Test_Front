<div class="history-container">
  <h2>ðŸ“œ Historique des paiements</h2>

  <div *ngIf="loading" class="loading">Chargement des transactions...</div>
  <div *ngIf="error && !loading" class="error">{{ error }}</div>

  <table *ngIf="!loading && transactions.length">
    <thead>
      <tr>
        <th>Date</th>
        <th>Nom complet</th>
        <th>Montant</th>
        <th>Statut</th>
        <th>Comptable</th>
        <th>Quittance</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let tx of transactions">
        <td>{{ tx.created_at | date:'short' }}</td>
        <td>{{ tx.additional_info.firstname }} {{ tx.additional_info.lastname }}</td>
        <td>{{ tx.amount | number:'1.2-2' }} FCFA</td>
        <td [ngClass]="tx.status">{{ tx.status }}</td>
        <td>{{ tx.accountant_name || 'â€”' }}</td>
        <td>
          <span *ngIf="tx.generate_receipt">ðŸ§¾ Oui</span>
          <span *ngIf="!tx.generate_receipt">â€”</span>
        </td>
        <td>
          <button 
            *ngIf="tx.generate_receipt && tx.status === 'COMPLETED'"
            class="btn-download"
            (click)="downloadReceipt(tx.order_id)">
            TÃ©lÃ©charger PDF
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && !transactions.length" class="no-data">
    Aucun paiement enregistrÃ© pour le moment.
  </div>
</div>
